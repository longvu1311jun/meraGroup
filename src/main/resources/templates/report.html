<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Báo cáo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
      :root{
        --bg: #f6f7f9;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #0d9488;
        --accent-2: #06b6d4;
        --border: #e6e9ee;
      }
      html,body{height:100%}
      body{
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        background:var(--bg);
        color:#0f1724;
        margin:0;
        padding:32px 20px;
      }
      .container{max-width:1400px;margin:0 auto}
      .card{
        background:var(--card);
        border-radius:12px;
        padding:20px;
        box-shadow:0 8px 24px rgba(16,24,40,0.06);
        border:1px solid var(--border);
      }
      .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
      .title{font-size:18px;font-weight:600}
      .sub{color:var(--muted);font-size:13px}
      .table-wrap{overflow:auto;border-radius:8px}
      table{width:100%;min-width:1300px;border-collapse:collapse;font-size:14px}
      thead th{position:sticky;top:0;background:linear-gradient(180deg,#ffffff,#fbfdfe);padding:12px 14px;text-align:left;font-weight:600;color:#0f1724;border-bottom:1px solid var(--border)}
      tbody tr{transition:background .12s ease}
      tbody tr:hover{background:#fbfeff}
      td,th{padding:10px 14px;border-bottom:1px solid var(--border)}
      .badge-accent{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;padding:4px 8px;border-radius:999px;font-weight:600;font-size:12px}
      .badge-danger{background:linear-gradient(90deg,#ef4444,#dc2626);color:#fff;padding:4px 8px;border-radius:999px;font-weight:600;font-size:12px}
      thead th.sort-asc::after{content:' ▲';font-size:12px;color:var(--muted)}
      thead th.sort-desc::after{content:' ▼';font-size:12px;color:var(--muted)}
      .small-muted{color:var(--muted);font-size:12px}
      @media (max-width:640px){
        .header{flex-direction:column;align-items:flex-start;gap:8px}
        .title{font-size:16px}
      }
    </style>
  </head>
  <body>
    <div class="topnav" style="position:sticky;top:0;z-index:40;padding:12px 20px;background:transparent">
      <div style="max-width:1400px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px">
        <div style="display:flex;align-items:center;gap:12px">
          <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(90deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700">RG</div>
          <div style="font-weight:600">Mera Report</div>
        </div>
        <nav style="display:flex;gap:18px;align-items:center">
          <a href="/" style="color:var(--muted);text-decoration:none">Dashboard</a>
          <a href="/report" style="color:var(--accent);text-decoration:none;font-weight:600">Reports</a>
          <a href="#" style="color:var(--muted);text-decoration:none">Users</a>
          <a href="#" style="color:var(--muted);text-decoration:none">Settings</a>
        </nav>
      </div>
    </div>

    <div class="container">
      <div class="card">
        <div class="header">
          <div>
            <div class="title">Báo cáo</div>
            <div class="sub">Tổng quan hiệu suất tư vấn viên</div>
          </div>
          <div class="small-muted">Cập nhật: <span id="updated">—</span></div>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Tư vấn viên</th>
                <th>Nhu cầu</th>
                <th>Trùng</th>
                <th>Rác</th>
                <th>Không tương tác</th>
                <th>Chốt nóng</th>
                <th>Chốt cũ</th>
                <th>Đơn huỷ</th>

                <th>Tổng mess</th>
                <th>Tổng đơn</th>
                <th>Đơn/mess nhu cầu</th>
                <th>Đơn/mess tổng</th>
                <th>Tỉ lệ huỷ</th>
              </tr>
            </thead>
            <tbody>
              <!-- 35 dòng demo -->
              <tr><td>Nguyễn Văn A</td><td class="small-muted">12</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">50</td><td class="small-muted">10</td><td class="small-muted">0.83</td><td class="small-muted">0.20</td><td><span class="badge-accent">10%</span></td></tr>
              <tr><td>Trần Thị B</td><td class="small-muted">8</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">30</td><td class="small-muted">6</td><td class="small-muted">0.75</td><td class="small-muted">0.20</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Lê Văn C</td><td class="small-muted">15</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">5</td><td class="small-muted">4</td><td class="small-muted">1</td><td class="small-muted">2</td><td class="small-muted">70</td><td class="small-muted">18</td><td class="small-muted">1.20</td><td class="small-muted">0.26</td><td><span class="badge-accent">11%</span></td></tr>
              <tr><td>Phạm Thị D</td><td class="small-muted">9</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">42</td><td class="small-muted">7</td><td class="small-muted">0.78</td><td class="small-muted">0.17</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Hoàng Văn E</td><td class="small-muted">20</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">6</td><td class="small-muted">6</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">95</td><td class="small-muted">28</td><td class="small-muted">1.40</td><td class="small-muted">0.29</td><td><span class="badge-accent">3%</span></td></tr>
              <tr><td>Đỗ Thị F</td><td class="small-muted">5</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">18</td><td class="small-muted">2</td><td class="small-muted">0.40</td><td class="small-muted">0.11</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Vũ Văn G</td><td class="small-muted">11</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">48</td><td class="small-muted">9</td><td class="small-muted">0.82</td><td class="small-muted">0.19</td><td><span class="badge-accent">11%</span></td></tr>
              <tr><td>Ngô Thị H</td><td class="small-muted">7</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">25</td><td class="small-muted">4</td><td class="small-muted">0.57</td><td class="small-muted">0.16</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Phan Văn I</td><td class="small-muted">14</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">5</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">62</td><td class="small-muted">15</td><td class="small-muted">1.07</td><td class="small-muted">0.24</td><td><span class="badge-accent">6%</span></td></tr>
              <tr><td>Trương Thị J</td><td class="small-muted">6</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">22</td><td class="small-muted">3</td><td class="small-muted">0.50</td><td class="small-muted">0.14</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Đặng Văn K</td><td class="small-muted">18</td><td class="small-muted">5</td><td class="small-muted">2</td><td class="small-muted">7</td><td class="small-muted">5</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">88</td><td class="small-muted">22</td><td class="small-muted">1.22</td><td class="small-muted">0.25</td><td><span class="badge-accent">9%</span></td></tr>
              <tr><td>Hà Thị L</td><td class="small-muted">4</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">12</td><td class="small-muted">1</td><td class="small-muted">0.25</td><td class="small-muted">0.08</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Văn Quang M</td><td class="small-muted">13</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">54</td><td class="small-muted">12</td><td class="small-muted">0.92</td><td class="small-muted">0.22</td><td><span class="badge-accent">8%</span></td></tr>
              <tr><td>Nguyễn Thị N</td><td class="small-muted">10</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">45</td><td class="small-muted">9</td><td class="small-muted">0.90</td><td class="small-muted">0.20</td><td><span class="badge-accent">11%</span></td></tr>
              <tr><td>Trần Văn O</td><td class="small-muted">16</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">6</td><td class="small-muted">4</td><td class="small-muted">1</td><td class="small-muted">2</td><td class="small-muted">76</td><td class="small-muted">20</td><td class="small-muted">1.25</td><td class="small-muted">0.26</td><td><span class="badge-accent">10%</span></td></tr>
              <tr><td>Phùng Thị P</td><td class="small-muted">3</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">8</td><td class="small-muted">0</td><td class="small-muted">0.00</td><td class="small-muted">0.00</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Đỗ Văn Q</td><td class="small-muted">17</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">5</td><td class="small-muted">5</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">82</td><td class="small-muted">21</td><td class="small-muted">1.24</td><td class="small-muted">0.26</td><td><span class="badge-accent">5%</span></td></tr>
              <tr><td>Huỳnh Thị R</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">6</td><td class="small-muted">1</td><td class="small-muted">0.50</td><td class="small-muted">0.17</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Nguyễn Văn S</td><td class="small-muted">19</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">8</td><td class="small-muted">6</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">100</td><td class="small-muted">25</td><td class="small-muted">1.32</td><td class="small-muted">0.25</td><td><span class="badge-accent">8%</span></td></tr>
              <tr><td>Trần Thị T</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">3</td><td class="small-muted">0</td><td class="small-muted">0.00</td><td class="small-muted">0.00</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Lê Thị U</td><td class="small-muted">21</td><td class="small-muted">5</td><td class="small-muted">4</td><td class="small-muted">9</td><td class="small-muted">7</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">110</td><td class="small-muted">30</td><td class="small-muted">1.43</td><td class="small-muted">0.27</td><td><span class="badge-accent">3%</span></td></tr>
              <tr><td>Phạm Văn V</td><td class="small-muted">22</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">6</td><td class="small-muted">8</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">120</td><td class="small-muted">33</td><td class="small-muted">1.50</td><td class="small-muted">0.28</td><td><span class="badge-accent">6%</span></td></tr>
              <tr><td>Võ Thị W</td><td class="small-muted">6</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">24</td><td class="small-muted">4</td><td class="small-muted">0.67</td><td class="small-muted">0.17</td><td><span class="badge-accent">25%</span></td></tr>
              <tr><td>Ngô Văn X</td><td class="small-muted">9</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">40</td><td class="small-muted">6</td><td class="small-muted">0.67</td><td class="small-muted">0.15</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Trịnh Thị Y</td><td class="small-muted">8</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">2</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">34</td><td class="small-muted">5</td><td class="small-muted">0.62</td><td class="small-muted">0.15</td><td><span class="badge-accent">20%</span></td></tr>
              <tr><td>Phan Văn Z</td><td class="small-muted">12</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">58</td><td class="small-muted">11</td><td class="small-muted">0.92</td><td class="small-muted">0.19</td><td><span class="badge-accent">9%</span></td></tr>
              <tr><td>Nguyễn Văn AA</td><td class="small-muted">14</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">5</td><td class="small-muted">4</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">68</td><td class="small-muted">14</td><td class="small-muted">1.00</td><td class="small-muted">0.21</td><td><span class="badge-accent">7%</span></td></tr>
              <tr><td>Trần Thị BB</td><td class="small-muted">11</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">50</td><td class="small-muted">9</td><td class="small-muted">0.82</td><td class="small-muted">0.18</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Lê Văn CC</td><td class="small-muted">10</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">4</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">46</td><td class="small-muted">8</td><td class="small-muted">0.80</td><td class="small-muted">0.17</td><td><span class="badge-accent">12%</span></td></tr>
              <tr><td>Phạm Thị DD</td><td class="small-muted">7</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">28</td><td class="small-muted">3</td><td class="small-muted">0.43</td><td class="small-muted">0.11</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Hoàng Văn EE</td><td class="small-muted">23</td><td class="small-muted">6</td><td class="small-muted">4</td><td class="small-muted">10</td><td class="small-muted">9</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">130</td><td class="small-muted">38</td><td class="small-muted">1.65</td><td class="small-muted">0.29</td><td><span class="badge-accent">5%</span></td></tr>
              <tr><td>Đỗ Thị FF</td><td class="small-muted">2</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">5</td><td class="small-muted">0</td><td class="small-muted">0.00</td><td class="small-muted">0.00</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Vũ Văn GG</td><td class="small-muted">15</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">5</td><td class="small-muted">4</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">72</td><td class="small-muted">17</td><td class="small-muted">1.13</td><td class="small-muted">0.24</td><td><span class="badge-accent">6%</span></td></tr>
              <tr><td>Ngô Thị HH</td><td class="small-muted">9</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">36</td><td class="small-muted">5</td><td class="small-muted">0.56</td><td class="small-muted">0.14</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Phan Văn II</td><td class="small-muted">12</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">4</td><td class="small-muted">3</td><td class="small-muted">1</td><td class="small-muted">1</td><td class="small-muted">60</td><td class="small-muted">13</td><td class="small-muted">1.08</td><td class="small-muted">0.22</td><td><span class="badge-accent">7%</span></td></tr>
              <tr><td>Trương Thị JJ</td><td class="small-muted">8</td><td class="small-muted">0</td><td class="small-muted">1</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">0</td><td class="small-muted">0</td><td class="small-muted">30</td><td class="small-muted">4</td><td class="small-muted">0.50</td><td class="small-muted">0.13</td><td><span class="badge-accent">0%</span></td></tr>
              <tr><td>Đặng Văn KK</td><td class="small-muted">17</td><td class="small-muted">3</td><td class="small-muted">2</td><td class="small-muted">6</td><td class="small-muted">5</td><td class="small-muted">2</td><td class="small-muted">1</td><td class="small-muted">86</td><td class="small-muted">19</td><td class="small-muted">1.12</td><td class="small-muted">0.22</td><td><span class="badge-accent">5%</span></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        var updated = document.getElementById('updated');
        if(updated) updated.textContent = new Date().toLocaleString();

        // highlight percent > 10% (strict)
        document.querySelectorAll('td span.badge-accent').forEach(function(el){
          var txt = el.textContent.trim();
          var m = txt.match(/([\d\.]+)%/);
          if(m){
            var val = parseFloat(m[1]);
            if(val > 10){
              el.classList.add('badge-danger');
            }
          }
        });

        // table sorting (click cycle: none -> asc -> desc -> none)
        var table = document.querySelector('table');
        if(!table) return;
        var tbody = table.querySelector('tbody');
        var rows = Array.from(tbody.querySelectorAll('tr'));
        rows.forEach(function(r,i){ r.dataset.originalIndex = i; });

        var ths = Array.from(table.querySelectorAll('thead th'));
        ths.forEach(function(th, idx){
          th.style.cursor = 'pointer';
          th.dataset.sortState = 'none';
          th.addEventListener('click', function(){
            // cycle state
            var state = th.dataset.sortState;
            // reset others
            ths.forEach(function(o){ if(o !== th){ o.dataset.sortState = 'none'; o.classList.remove('sort-asc','sort-desc'); } });
            if(state === 'none'){
              th.dataset.sortState = 'asc';
              th.classList.remove('sort-desc'); th.classList.add('sort-asc');
              sortByColumn(idx, true);
            } else if(state === 'asc'){
              th.dataset.sortState = 'desc';
              th.classList.remove('sort-asc'); th.classList.add('sort-desc');
              sortByColumn(idx, false);
            } else {
              th.dataset.sortState = 'none';
              th.classList.remove('sort-desc');
              restoreOriginal();
            }
          });
        });

        function getCellValue(row, idx){
          var cell = row.children[idx];
          if(!cell) return '';
          var span = cell.querySelector('span');
          var txt = span ? span.textContent.trim() : cell.textContent.trim();
          if(txt === '') return '';
          // percent values like "12%" -> number
          if(/^[\d.,]+%$/.test(txt)){
            return parseFloat(txt.replace('%','').replace(/,/g,''));
          }
          // numeric values
          var n = parseFloat(txt.replace(/,/g,''));
          if(!isNaN(n)) return n;
          return txt.toLowerCase();
        }

        function sortByColumn(idx, asc){
          var sorted = rows.slice().sort(function(a,b){
            var A = getCellValue(a, idx);
            var B = getCellValue(b, idx);
            var aNum = typeof A === 'number';
            var bNum = typeof B === 'number';
            if(aNum && bNum) return asc ? A - B : B - A;
            if(aNum) return asc ? -1 : 1;
            if(bNum) return asc ? 1 : -1;
            if(A < B) return asc ? -1 : 1;
            if(A > B) return asc ? 1 : -1;
            return 0;
          });
          sorted.forEach(function(r){ tbody.appendChild(r); });
        }

        function restoreOriginal(){
          var original = rows.slice().sort(function(a,b){ return a.dataset.originalIndex - b.dataset.originalIndex; });
          original.forEach(function(r){ tbody.appendChild(r); });
        }
      });
    </script>
  </body>
</html>
